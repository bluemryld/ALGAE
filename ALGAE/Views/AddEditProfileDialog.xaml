<Window x:Class="ALGAE.Views.AddEditProfileDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        Title="Profile" Height="600" Width="700"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize"
        Style="{StaticResource MaterialDesignWindow}">
    <Grid Margin="24">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,24">
            <materialDesign:PackIcon Kind="Account" Width="32" Height="32" 
                                     Foreground="{DynamicResource PrimaryHueMidBrush}"
                                     VerticalAlignment="Center" Margin="0,0,12,0"/>
            <TextBlock Text="Profile Configuration" 
                       Style="{StaticResource MaterialDesignHeadline5TextBlock}"
                       VerticalAlignment="Center"/>
        </StackPanel>

        <!-- Form -->
        <StackPanel Grid.Row="1">
            <TextBox materialDesign:HintAssist.Hint="Profile Name"
                     materialDesign:HintAssist.IsFloating="True"
                     Text="{Binding ProfileName, UpdateSourceTrigger=PropertyChanged}"
                     Style="{StaticResource MaterialDesignOutlinedTextBox}"
                     MaxLength="100"
                     Margin="0,0,0,16"/>

            <TextBox materialDesign:HintAssist.Hint="Command Line Arguments (Optional)"
                     materialDesign:HintAssist.IsFloating="True"
                     Text="{Binding CommandLineArgs, UpdateSourceTrigger=PropertyChanged}"
                     Style="{StaticResource MaterialDesignOutlinedTextBox}"
                     AcceptsReturn="True"
                     TextWrapping="Wrap"
                     MaxHeight="120"
                     VerticalScrollBarVisibility="Auto"
                     Margin="0,0,0,16"/>

            <!-- Companion Apps Section -->
            <materialDesign:Card Padding="16" Background="{DynamicResource MaterialDesignCardBackground}" Margin="0,0,0,16">
                <StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                        <materialDesign:PackIcon Kind="Apps" Width="16" Height="16" 
                                                 Foreground="{DynamicResource PrimaryHueMidBrush}"
                                                 VerticalAlignment="Center" Margin="0,0,8,0"/>
                        <TextBlock Text="Companion Applications" 
                                   Style="{StaticResource MaterialDesignBody2TextBlock}"
                                   FontWeight="SemiBold"/>
                    </StackPanel>
                    <TextBlock Text="Select which companion applications should be launched automatically with this profile."
                               Style="{StaticResource MaterialDesignBody2TextBlock}"
                               Foreground="{DynamicResource MaterialDesignBodyLight}"
                               TextWrapping="Wrap" Margin="0,0,0,12"/>
                    
                    <!-- Companions List -->
                    <ScrollViewer MaxHeight="200" VerticalScrollBarVisibility="Auto">
                        <ItemsControl ItemsSource="{Binding AvailableCompanions}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <materialDesign:Card Margin="0,0,0,8" Padding="12">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            
                                            <!-- Checkbox -->
                                            <CheckBox Grid.Column="0" IsChecked="{Binding IsEnabled}" 
                                                      VerticalAlignment="Center" Margin="0,0,12,0"/>
                                            
                                            <!-- Icon -->
                                            <Border Grid.Column="1" Width="24" Height="24" 
                                                    Background="{DynamicResource AccentColorBrush}"
                                                    CornerRadius="12" Margin="0,0,12,0">
                                                <materialDesign:PackIcon Kind="Application" Width="12" Height="12" 
                                                                         Foreground="White" 
                                                                         HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                            
                                            <!-- Info -->
                                            <StackPanel Grid.Column="2" VerticalAlignment="Center">
                                                <TextBlock Text="{Binding Companion.Name}" 
                                                           Style="{StaticResource MaterialDesignBody1TextBlock}"
                                                           FontWeight="SemiBold"/>
                                                <StackPanel Orientation="Horizontal">
                                                    <materialDesign:Chip Content="{Binding Companion.Type}" 
                                                                         Style="{StaticResource MaterialDesignOutlineChip}"
                                                                         FontSize="10" Margin="0,2,8,0"/>
                                                    <TextBlock Text="{Binding Companion.PathOrURL}" 
                                                               Style="{StaticResource MaterialDesignCaptionTextBlock}"
                                                               Foreground="{DynamicResource MaterialDesignBodyLight}"
                                                               TextTrimming="CharacterEllipsis" VerticalAlignment="Center"/>
                                                </StackPanel>
                                            </StackPanel>
                                        </Grid>
                                    </materialDesign:Card>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                    
                    <!-- Empty State -->
                    <TextBlock Text="No companion applications configured for this game." 
                               Style="{StaticResource MaterialDesignCaptionTextBlock}"
                               Foreground="{DynamicResource MaterialDesignBodyLight}"
                               HorizontalAlignment="Center"
                               Visibility="{Binding HasNoCompanions, Converter={StaticResource BooleanToVisibilityConverter}}"
                               Margin="0,24,0,0"/>
                </StackPanel>
            </materialDesign:Card>

            <materialDesign:Card Padding="16" Background="{DynamicResource MaterialDesignCardBackground}">
                <StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                        <materialDesign:PackIcon Kind="InformationOutline" Width="16" Height="16" 
                                                 Foreground="{DynamicResource MaterialDesignBodyLight}"
                                                 VerticalAlignment="Center" Margin="0,0,8,0"/>
                        <TextBlock Text="Profile Information" 
                                   Style="{StaticResource MaterialDesignBody2TextBlock}"
                                   FontWeight="SemiBold"/>
                    </StackPanel>
                    <TextBlock Text="Profiles allow you to launch the same game with different configurations. You can specify custom command line arguments and enable companion applications for each profile."
                               Style="{StaticResource MaterialDesignBody2TextBlock}"
                               Foreground="{DynamicResource MaterialDesignBodyLight}"
                               TextWrapping="Wrap"/>
                    <TextBlock Text="Examples: --windowed, --resolution=1920x1080, --debug"
                               Style="{StaticResource MaterialDesignCaptionTextBlock}"
                               Foreground="{DynamicResource MaterialDesignBodyLight}"
                               Margin="0,8,0,0"/>
                </StackPanel>
            </materialDesign:Card>
        </StackPanel>

        <!-- Buttons -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,24,0,0">
            <Button Content="Cancel" 
                    Style="{StaticResource MaterialDesignOutlinedButton}"
                    IsCancel="True"
                    Margin="0,0,12,0"
                    Click="CancelButton_Click"/>
            <Button Content="Save Profile"
                    Style="{StaticResource MaterialDesignRaisedButton}"
                    IsDefault="True"
                    Click="SaveButton_Click"/>
        </StackPanel>
    </Grid>
</Window>
